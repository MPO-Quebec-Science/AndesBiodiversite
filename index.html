<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Helper Functions to easily Access ANDES database Data formated for the Biodiversity Team • AndesBiodiversite</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Helper Functions to easily Access ANDES database Data formated for the Biodiversity Team">
<meta name="description" content="Ce package contient une collection de fonctions utilitaires pour accéder facilement aux données des tables ANDES sous forme conviviale de dataframes. Il peut également inclure des fonctions de validation et de gestion de données.">
<meta property="og:description" content="Ce package contient une collection de fonctions utilitaires pour accéder facilement aux données des tables ANDES sous forme conviviale de dataframes. Il peut également inclure des fonctions de validation et de gestion de données.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">AndesBiodiversite</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/column_definitions.html">Format des données</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="andes-biodiversité">ANDES Biodiversité<a class="anchor" aria-label="anchor" href="#andes-biodiversit%C3%A9"></a>
</h1></div>
<p><a href="https://github.com/MPO-Quebec-Science/AndesBiodiversite/actions/workflows/documentation.yml" class="external-link"><img src="https://github.com/MPO-Quebec-Science/AndesBiodiversite/actions/workflows/documentation.yml/badge.svg" alt="Docs"></a></p>
<p>Ce dépot contient des wrappers en <code>R</code> de commandes <code>SQL</code> pour extraire des données de biodiversité (équipe IML de la région du Québec) fait avec ANDES.</p>
<p>Voir la documentation complète ici: <a href="https://mpo-quebec-science.github.io/AndesBiodiversite/" class="external-link uri">https://mpo-quebec-science.github.io/AndesBiodiversite/</a></p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<ul>
<li>installer le pilote MySQL <code>MySQL Connector ODBC</code> du centre logiciel</li>
<li>installer le package devtools <code>install.packages("devtools")</code>
</li>
<li>utiliser devtools pour installer le package <code>devtools::install_github("MPO-Quebec-Science/AndesBiodiversite")</code>
</li>
</ul>
<div class="section level2">
<h2 id="installation-de-pilotes-mysql">Installation de pilotes MySQL<a class="anchor" aria-label="anchor" href="#installation-de-pilotes-mysql"></a>
</h2>
<p>Les requetes de la BD MySQL Andes requiert un pilote. Le pilote <code>{MySQL ODBC 8.0 Unicode Driver}</code> devraient être disponible pour les postes standards du MPO. Il peut être installé via le center logiciel. Nom: <code>MySQL Connector ODBC</code> Version <code>8.0.22</code> URL: <code>softwarecenter:SoftwareID=ScopeId_A90E3BBE-DB35-4A92-A44E-15F8C7C595B3/Application_dec16a4a-d57f-44b1-8a9f-8f6267f34539</code></p>
<p>Une fois le pilote installé, essayez la commande <code>odbc::odbcListDrivers()</code> pour confirmé sa présence.</p>
</div>
</div>
<div class="section level1">
<h1 id="utilisation">Utilisation<a class="anchor" aria-label="anchor" href="#utilisation"></a>
</h1>
<ol style="list-style-type: decimal">
<li>Donner les détails de la connexion et établir un connexion</li>
<li>Obtenir les données avec <code><a href="reference/get_biodiv_data.html">get_biodiv_data()</a></code> et <code><a href="reference/get_OBIS_archive.html">get_OBIS_archive()</a></code>
</li>
</ol>
<div class="section level2">
<h2 id="id_1-connexion-et-authentification-a-la-bd-andes">1. Connexion et authentification a la BD ANDES<a class="anchor" aria-label="anchor" href="#id_1-connexion-et-authentification-a-la-bd-andes"></a>
</h2>
<p>Il est FORTEMENT DÉCONSIELLER de mettre les mots de passes directement dans un script (mais vouz pouvez le faire temporairement pour déboguguer). Il faut voir les scripts comme étant publique et ouvert a tous.</p>
<p>Pour sauvegarder les mots de passes de BD, il faut faire une copie du fichier gabarit <code>exemple.Renviron</code> et le nomer <code>.Renviron</code>. Par la suite il faut remplir le nom d’usagé et le mot de passe pour pouvoir faire une connexion a la BD. Il est possible de falloir redémarré <code>R</code> apres avoir modifier <code>.Renviron</code> car la lecture est uniquement fait au démarage de <code>R</code>. Le fichier <code>.Renviron</code> peut être placé dans le dossier home de l’usager <code>C:\Users\TON_NOM</code> (sur windows) ou <code>/home/TON_NOM</code> (sur Linux).</p>
<p>Ces informations seront par la suite disponnible via la fonction <code><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv()</a></code>, comme dans cette exemple ci-bas.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Infos connexion BD, voir section Authentification Connexion BD</span></span>
<span><span class="va">url_bd</span> <span class="op">&lt;-</span> <span class="st">"iml-science-4.ent.dfo-mpo.ca"</span></span>
<span><span class="va">port_bd</span> <span class="op">&lt;-</span> <span class="fl">25988</span></span>
<span><span class="va">nom_bd</span> <span class="op">&lt;-</span> <span class="st">"andesdb"</span></span>
<span><span class="va">nom_usager</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"NOM_USAGER_BD"</span><span class="op">)</span></span>
<span><span class="va">mot_de_passe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MOT_DE_PASSE_BD"</span><span class="op">)</span></span></code></pre></div>
<p>Tester la connexion</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># établir connexion BD (il faut être sur le réseau MPO)</span></span>
<span><span class="va">andes_db_connection</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/andes_db_connect.html">andes_db_connect</a></span><span class="op">(</span></span>
<span>  url_bd <span class="op">=</span> <span class="va">url_bd</span>,</span>
<span>  port_bd <span class="op">=</span> <span class="va">port_bd</span>,</span>
<span>  nom_usager <span class="op">=</span> <span class="va">nom_usager</span>,</span>
<span>  mot_de_passe <span class="op">=</span> <span class="va">mot_de_passe</span>,</span>
<span>  nom_bd <span class="op">=</span> <span class="va">nom_bd</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_1-obtenir-les-données-avec-get_biodiv_data-et-get_obis_archive">1. Obtenir les données avec <code>get_biodiv_data()</code> et <code>get_OBIS_archive()</code>
<a class="anchor" aria-label="anchor" href="#id_1-obtenir-les-donn%C3%A9es-avec-get_biodiv_data-et-get_obis_archive"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_biodiv_data.html">get_biodiv_data</a></span><span class="op">(</span><span class="va">andes_db_connection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"IML-2024-009-quantitative.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_obis</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_OBIS_archive.html">get_OBIS_archive</a></span><span class="op">(</span><span class="va">andes_db_connection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df_obis</span><span class="op">$</span><span class="va">event</span>, <span class="st">"IML-2024-009-event.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df_obis</span><span class="op">$</span><span class="va">occurrence</span>, <span class="st">"IML-2024-009-occurrence.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="guide-developpement-avancé">Guide developpement (avancé)<a class="anchor" aria-label="anchor" href="#guide-developpement-avanc%C3%A9"></a>
</h1>
<p>Pour modifier ce package, il ne faut pas l’installer proprement dit, mais le “loader” à partir du code source (qu’on va vouloir éventuellement modifier).</p>
<p>Il faut faire une séparation entre le code source <em>du package</em> et le code qui <em>utilise</em> le package.</p>
<p>Le code source R du package lui-même réside sous le dossier <code>./R/</code> (et <code>./inst/</code>). Le code qui <em>utilise</em> le package ne doit jamais se trouver là! Le code qui utilise le package réside chez les évaluateurs / utilisateurs et pas dans ce dépot git.</p>
<p>Par contre, en tant que dévéloppeur du package il est pratique de pouvoir faire usage du package en meme parallel, cela permet de tester nos ajouts/modifications a mesure. Veuillez voir <code>run.R</code> comme exemple.</p>
<p>Pour loader le package avec le code présent sous <code>./R/</code> (donc sans installer le package lui-meme), utiliser la fonction <code>devtools::load_all()</code>, vous pourriez ensuite utiliser les fonctions disponibles.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">load_all</span>()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ℹ Loading AndesBiodiversite</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">&gt;</span> df <span class="ot">&lt;-</span> <span class="fu">get_biodiv_data</span>(andes_db_connection)</span></code></pre></div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Documenter brievement les fonctions individuelles avec des commentaires sous le format <code>doxygen</code>. Par exemple, ceci pourrait être le contenu du fichier <code>./R/add.R</code> :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Add together two numbers</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param x A numeric value.</span></span>
<span><span class="co">#' @param y A numeric value.</span></span>
<span><span class="co">#' @return The sum of `x` and `y`.</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' add(1, 2)</span></span>
<span><span class="co">#' add(5, 10)</span></span>
<span><span class="va">add</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Utiliser la fonction <code>devtools::document()</code> pour mettre a jour la documentation dans <code>./man/</code> en utilisant les commentaires <code>doxygen</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">document</span>()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>ℹ Updating AndesBiodiversite documentation</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>ℹ Loading AndesBiodiversite</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>Writing NAMESPACE</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>Writing add.Rd</span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing AndesBiodiversite</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>David Sean-Fortin <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Sean-Fortin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
