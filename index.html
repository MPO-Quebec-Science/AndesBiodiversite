<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helper Functions to easily Access ANDES database Data formated for the Biodiversity Team • AndesBiodiversite</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Helper Functions to easily Access ANDES database Data formated for the Biodiversity Team">
<meta property="og:description" content="Ce package contient une collection de fonctions utilitaires pour accéder facilement aux données des tables ANDES sous forme conviviale de dataframes. Il peut également inclure des fonctions de validation et de gestion de données.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">AndesBiodiversite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/column_definitions.html">Format des données quantitatives</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="andes-biodiversité">ANDES Biodiversité<a class="anchor" aria-label="anchor" href="#andes-biodiversit%C3%A9"></a>
</h1></div>
<p>Ce dépot contient des wrappers en <code>R</code> de commandes <code>SQL</code> pour extraire des données de biodiversité (équipe IML de la région du Québec) fait avec ANDES.</p>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<p>The <code>{MySQL ODBC 8.0 Unicode Driver}</code> should be available on DFO workstations. It can be installed in the software center. Name: MySQL Connector ODBC Version 8.0.22</p>
<p>URL: softwarecenter:SoftwareID=ScopeId_A90E3BBE-DB35-4A92-A44E-15F8C7C595B3/Application_dec16a4a-d57f-44b1-8a9f-8f6267f34539</p>
<p>List available drivers <code>using odbc::odbcListDrivers()</code> and see if it is present.</p>
</div>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<ul>
<li>installer le <code>MySQL Connector ODBC</code> du centre logiciel</li>
<li>installer le package devtools <code>install.packages("devtools")</code>
</li>
<li>installer devtools pour install le package <code>devtools::install_github("MPO-Quebec-Science/AndesBiodiversite")</code>
</li>
</ul>
</div>
<div class="section level1">
<h1 id="utilisation">Utilisation<a class="anchor" aria-label="anchor" href="#utilisation"></a>
</h1>
<ol style="list-style-type: decimal">
<li>Donner les détails de la connexion et établir un connexion</li>
<li>Obtenir les données avec <code><a href="reference/get_biodiv_data.html">get_biodiv_data()</a></code> et <code>get_OBIS_archive()</code>
</li>
</ol>
<div class="section level2">
<h2 id="connexion-et-authentification-a-la-bd-andes">Connexion et authentification a la BD ANDES<a class="anchor" aria-label="anchor" href="#connexion-et-authentification-a-la-bd-andes"></a>
</h2>
<p>Il est FORTEMENT DÉCONSIELLER de mettre les mots de passes directement dans un script (mais vouz pouvez le faire temporairement pour déboguguer). Il faut voir les scripts comme étant publique et ouvert a tous.</p>
<p>Pour sauvegarder les mots de passes de BD, il faut faire une copie du fichier gabarit <code>exemple.Renviron</code> et le nomer <code>.Renviron</code>. Par la suite il faut remplir le nom d’usagé et le mot de passe pour pouvoir faire une connexion a la BD. Il est possible de falloir redémarré <code>R</code> apres avoir modifier <code>.Renviron</code> car la lecture est uniquement fait au démarage de <code>R</code>. Le fichier <code>.Renviron</code> peut être placé dans le dossier home de l’usager <code>C:\Users\TON_NOM</code> (sur windows) ou <code>/home/TON_NOM</code> (sur Linux).</p>
<p>Ces informations seront par la suite disponnible via la fonction <code><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv()</a></code>, comme dans cette exemple ci-bas.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Infos connexion BD, voir section Authentification Connexion BD</span></span>
<span><span class="va">url_bd</span> <span class="op">&lt;-</span> <span class="st">"iml-science-4.ent.dfo-mpo.ca"</span></span>
<span><span class="va">port_bd</span> <span class="op">&lt;-</span> <span class="fl">25988</span></span>
<span><span class="va">nom_bd</span> <span class="op">&lt;-</span> <span class="st">"andesdb"</span></span>
<span><span class="va">nom_usager</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"NOM_USAGER_BD"</span><span class="op">)</span></span>
<span><span class="va">mot_de_passe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MOT_DE_PASSE_BD"</span><span class="op">)</span></span></code></pre></div>
<p>Tester la connexion</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># établir connexion BD (il faut être sur le réseau MPO)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"R/andes_db_connect.R"</span><span class="op">)</span></span>
<span><span class="va">andes_db_connection</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/andes_db_connect.html">andes_db_connect</a></span><span class="op">(</span></span>
<span>  url_bd <span class="op">=</span> <span class="va">url_bd</span>,</span>
<span>  port_bd <span class="op">=</span> <span class="va">port_bd</span>,</span>
<span>  nom_usager <span class="op">=</span> <span class="va">nom_usager</span>,</span>
<span>  mot_de_passe <span class="op">=</span> <span class="va">mot_de_passe</span>,</span>
<span>  nom_bd <span class="op">=</span> <span class="va">nom_bd</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_biodiv_data.html">get_biodiv_data</a></span><span class="op">(</span><span class="va">andes_db_connection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"IML-2024-009-quantitative.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_obis</span> <span class="op">&lt;-</span> <span class="fu">get_OBIS_archive</span><span class="op">(</span><span class="va">andes_db_connection</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df_obis</span><span class="op">$</span><span class="va">event</span>, <span class="st">"IML-2024-009-event.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df_obis</span><span class="op">$</span><span class="va">occurrence</span>, <span class="st">"IML-2024-009-occurrence.csv"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="guide-developpement">Guide developpement<a class="anchor" aria-label="anchor" href="#guide-developpement"></a>
</h1>
<p>Pour modifier ce package, il ne faut pas l’installer proprement dit, mais le “loader” à partir du code source (qu’on va vouloir éventuellement modifier).</p>
<p>Il faut faire une séparation entre le code source <em>du package</em> et le code qui <em>utilise</em> le package.</p>
<p>Le code source R du package lui-même réside sous le dossier <code>./R/</code> (et <code>./inst/</code>). Le code qui <em>utilise</em> le package ne doit jamais se trouver là! Le code qui utilise le package réside chez les évaluateurs / utilisateurs et pas dans ce dépot git.</p>
<p>Par contre, en tant que dévéloppeur du package il est pratique de pouvoir faire usage du package en meme parallel, cela permet de tester nos ajouts/modifications a mesure. Veuillez voir <code>run.R</code> comme exemple.</p>
<p>Pour loader le package avec le code présent sous <code>./R/</code> (donc sans installer le package lui-meme), utiliser la fonction <code>devtools::load_all()</code>, vous pourriez ensuite utiliser les fonctions disponibles.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">load_all</span>()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>ℹ Loading AndesBiodiversite</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="sc">&gt;</span> df <span class="ot">&lt;-</span> <span class="fu">get_biodiv_data</span>(andes_db_connection)</span></code></pre></div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Documenter brievement les fonctions individuelles avec des commentaires sous le format <code>doxygen</code>. Par exemple, ceci pourrait être le contenu du fichier <code>./R/add.R</code> :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Add together two numbers</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param x A numeric value.</span></span>
<span><span class="co">#' @param y A numeric value.</span></span>
<span><span class="co">#' @return The sum of `x` and `y`.</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' add(1, 2)</span></span>
<span><span class="co">#' add(5, 10)</span></span>
<span><span class="va">add</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Utiliser la fonction <code>devtools::document()</code> pour mettre a jour la documentation dans <code>./man/</code> en utilisant les commentaires <code>doxygen</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">document</span>()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>ℹ Updating AndesBiodiversite documentation</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>ℹ Loading AndesBiodiversite</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>Writing NAMESPACE</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>Writing add.Rd</span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing AndesBiodiversite</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>David Sean-Fortin <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by David Sean-Fortin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
